{
  "name": "@EFFECTS_VINTAGE",
  "nodes": [
    {
      "parameters": {
        "inputSource": "jsonExample",
        "jsonExample": "{\n  \"FILENAME\": \"_LMpN6o26E0_00_00_00_00_00_06.mp4\",\n  \"V_SAT\": 0.5,\n  \"V_CONTRAST\": 1.1,\n  \"V_BRIGHT\": 0.05,\n  \"V_GRAIN\": 35,\n  \"V_FLAGS\": \"u+t\",\n  \"V_SEED\": 123,\n  \"V_VIGN\": \"PI/4\"\n}\n"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -1168,
        -112
      ],
      "id": "4bc79835-24f0-48ef-8fed-e3cca45da532",
      "name": "START"
    },
    {
      "parameters": {
        "command": "={{ $json.command }}"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -80,
        -112
      ],
      "id": "020684f2-d32e-44cb-8054-5c5d2274e5aa",
      "name": "COMMAND"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a9a6d8d1-dbd3-47e1-984a-202445146564",
              "name": "FILENAME",
              "value": "={{ $json.FILENAME }}",
              "type": "string"
            },
            {
              "id": "cd520121-d1dd-44d1-ae9c-0fad569de67e",
              "name": "NOISE_STRENGTH",
              "value": "={{ $json.NOISE_STRENGTH }}",
              "type": "number"
            },
            {
              "id": "9b755ec2-40c6-4115-9ad2-f9e6bf440fa1",
              "name": "NOISE_FLAGS ",
              "value": "={{ $json['NOISE_FLAGS '] }}",
              "type": "string"
            },
            {
              "id": "9a663f5c-38a1-4536-b7f8-b27ef2ff3008",
              "name": "NOISE_SEED  ",
              "value": "={{ $json['NOISE_SEED  '] }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -320,
        -112
      ],
      "id": "ce0910f4-7bd6-4404-8534-8d69fde59a48",
      "name": "VAR"
    },
    {
      "parameters": {
        "jsCode": "// Inputs esperados:\n// FILENAME   -> ex: \"_LMpN6o26E0_00_00_00_00_00_06.mp4\" (em /home/node/processing)\n// V_SAT      -> satura√ß√£o (0‚Äì2, padr√£o 0.6)\n// V_CONTRAST -> contraste (0.5‚Äì2, padr√£o 1.05)\n// V_BRIGHT   -> brilho (-1‚Äì1, padr√£o 0)\n// V_GRAIN    -> intensidade do gr√£o (0‚Äì100, padr√£o 20)\n// V_FLAGS    -> flags do noise (\"u+t\" padr√£o)      // u=uniforme, g=gaussiano, p=positivo, t=temporal\n// V_SEED     -> semente do ru√≠do (0..2^32-1, padr√£o 42)\n// V_VIGN     -> par√¢metro do vignette (string opcional, ex: \"PI/4\")\n\nconst file = $json.FILENAME;\n\nconst V_SAT      = Number($json.V_SAT ?? 0.6);\nconst V_CONTRAST = Number($json.V_CONTRAST ?? 1.05);\nconst V_BRIGHT   = Number($json.V_BRIGHT ?? 0);\nconst V_GRAIN    = Number($json.V_GRAIN ?? 20);\nconst V_FLAGS    = ($json.V_FLAGS ?? 'u+t').toString();\nconst V_SEED     = Number($json.V_SEED ?? 42);\nconst V_VIGN     = $json.V_VIGN;\n\nconst BASE = '/home/node/processing';\n\n// Nome de sa√≠da\nconst safe = s => s.replace(/\\.[A-Za-z0-9]+$/,'').replace(/[^A-Za-z0-9_\\-]/g,'_');\nconst outFile = `${safe(file)}_VINTAGE_sat${V_SAT}_ct${V_CONTRAST}_gr${V_GRAIN}.mp4`;\n\n// Monta a vinheta\nconst vignettePart = V_VIGN ? `vignette=${V_VIGN}` : `vignette`;\n\n// Cadeia de filtros\nconst vf =\n  `eq=contrast=${V_CONTRAST}:brightness=${V_BRIGHT},` +\n  `hue=s=${V_SAT},` +\n  `noise=alls=${V_GRAIN}:allf=${V_FLAGS}:all_seed=${V_SEED},` +\n  `${vignettePart},` +\n  `format=yuv420p`;\n\nconst cmd =\n  `ffmpeg -y -i \"${BASE}/${file}\" ` +\n  `-vf \"${vf}\" ` +\n  `-c:v libx264 -preset veryfast -crf 20 -movflags +faststart ` +\n  `-c:a copy ` +\n  `\"${BASE}/${outFile}\"`;\n\nreturn {\n  command: cmd,\n  outputFile: outFile\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -208,
        -112
      ],
      "id": "5f62c54f-3f87-43c6-adad-c26ca4d97177",
      "name": "C0DE"
    },
    {
      "parameters": {
        "content": "## üé¨ Par√¢metros do efeito Vintage\n\n- **FILENAME** ‚Üí v√≠deo de entrada  \n  - Exemplo: `_LMpN6o26E0_00_00_00_00_00_06.mp4`  \n  - Local: `/home/node/processing`\n\n- **V_SAT** ‚Üí satura√ß√£o de cor  \n  - Faixa: 0 (sem cor) ‚Üí 2 (cores intensas)  \n  - Padr√£o: 0.6  \n\n- **V_CONTRAST** ‚Üí contraste  \n  - Faixa: 0.5 ‚Üí 2  \n  - Padr√£o: 1.05  \n\n- **V_BRIGHT** ‚Üí brilho  \n  - Faixa: -1 ‚Üí 1  \n  - Padr√£o: 0  \n\n- **V_GRAIN** ‚Üí intensidade do gr√£o/ru√≠do  \n  - Faixa: 0 ‚Üí 100  \n  - Padr√£o: 20  \n\n- **V_FLAGS** ‚Üí tipo de ru√≠do  \n  - Valores:  \n    - `u` = uniforme  \n    - `g` = gaussiano  \n    - `p` = positivo  \n    - `t` = temporal (ru√≠do muda ao longo do tempo)  \n  - Combina√ß√µes poss√≠veis: `u+t`, `g+t`, etc.  \n  - Padr√£o: `u+t`  \n\n- **V_SEED** ‚Üí semente do ru√≠do  \n  - Faixa: 0 ‚Üí 2^32-1  \n  - Padr√£o: 42  \n\n- **V_VIGN** ‚Üí vinheta (borda escura)  \n  - Tipo: string matem√°tica opcional  \n  - Exemplo: `\"PI/4\"` ‚Üí vinheta mais fechada  \n  - Se n√£o informado ‚Üí vinheta padr√£o\n",
        "height": 928,
        "width": 672,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1024,
        -112
      ],
      "typeVersion": 1,
      "id": "04b164bc-2bc4-460a-821c-091016eb7683",
      "name": "Sticky Note"
    }
  ],
  "pinData": {
    "START": [
      {
        "json": {
          "FILENAME": "_LMpN6o26E0_00_00_00_00_00_06.mp4",
          "V_SAT": 0.5,
          "V_CONTRAST": 1.8,
          "V_BRIGHT": 1.05,
          "V_GRAIN": 70,
          "V_FLAGS": "u+t",
          "V_SEED": 123,
          "V_VIGN": "PI/4"
        }
      }
    ]
  },
  "connections": {
    "START": {
      "main": [
        [
          {
            "node": "VAR",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "VAR": {
      "main": [
        [
          {
            "node": "C0DE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "C0DE": {
      "main": [
        [
          {
            "node": "COMMAND",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "2c0bae83-876a-4b53-a139-22a3baabe726",
  "meta": {
    "instanceId": "e562edbe74086864fad96dc54f91d130f73a43f334e27062d34cbaf271013692"
  },
  "id": "XsfPGEyzI5H88tY7",
  "tags": []
}